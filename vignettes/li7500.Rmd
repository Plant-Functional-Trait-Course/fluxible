---
title: "Using fluxible with the Li7500"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Preparing the data for fluxible}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: biblio_phd_zot.bib
csl: emerald-harvard.csl
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(tidyverse.quiet = TRUE)
```

In this vignette, we will see how to read the data from the setup described in @halbritterPlantTraitVegetation2024 and compare the output calculated with fluxible with the published data.

The code used to import the data might be turned into a package later.

## Importing and reading the files

First, we import the data from OSF with `dataDownloader::get_file`.

```{r osf-import, include = TRUE}
library(dataDownloader)

get_file("gs8u6",
         "rawData/raw_c-flux",
         "rawC-flux.zip",
         "vignettes/ex_data/li7500")

unzip("vignettes/ex_data/li7500/rawC-flux.zip",
      exdir = "vignettes/ex_data/li7500/rawC-flux")
```

Then we import the data with `licoread::import7500`.
```{r reading}
library(licoread)
data <- import7500(
  "vignettes/ex_data/li7500/rawC-flux/rawData/raw_tent-flux",
  comment = TRUE,
  plotinfo_names = c("site", "block", "date", "plot", "trial")
)
```

```{r reading-old, include = TRUE}
library(tidyverse)

raw_conc <- list.files( # list the files
  "vignettes/ex_data/li7500/rawC-flux/rawData/raw_tent-flux",
  full.names = TRUE,
  recursive = TRUE # to read in subfolders
) |>
  map_dfr(
    read_csv, # we map read_csv on all the files
    na = c("#N/A", "Over"), # "#N/A" and Over should be treated as NA
    show_col_types = FALSE # just to make it quiet
  ) |>
  rename(
    conc = "CO2 umol/mol"
  ) |>
  mutate(
    datetime = dmy_hms(`Date/Time`)
  ) |>
  select(datetime, conc)
```

## Processing with fluxible


## Comparison

### Importing and reading published data
